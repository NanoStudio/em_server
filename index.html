<!DOCTYPE html>
<html>
<head>
  <title>EventMachine</title>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>

  <script>
    var ws;
    var map = undefined;

    $(document).ready(function() {
      if (!("WebSocket" in window)) {
        alert("Sorry, WebSockets unavailable.");
        return;
      }

      ws = new WebSocket("ws://localhost:8080/");
      ws.onmessage = function (evt) {
        console.log(evt.data);
        $('#chat_area').append(evt.data + "<br />");
      };

      ws.onclose = function () {
        console.log("socket closed");
      };

      $('#submit').click(function () {
        send(this);
        $('#post_entry').val('');
        return false;
      });
    });

    function send(sender) {
      var val = $('#post_entry').val();
      if (val != '') ws.send(val);
    }
  </script>
</head>
<body>
  <form>
    <input type='text' id='post_entry' name='post_entry' placeholder='say' />&nbsp;
    <input type='submit' id='submit' />
  </form>
  <div id='chat_area'></div>
</body>
</html>